<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OSCP-8: Vulnerability Scanning" /><meta name="author" content="Adrià" /><meta property="og:locale" content="en" /><meta name="description" content="Chapter 8: Vulnerability Scanning" /><meta property="og:description" content="Chapter 8: Vulnerability Scanning" /><link rel="canonical" href="https://adriapt.github.io/posts/OSCP-8/" /><meta property="og:url" content="https://adriapt.github.io/posts/OSCP-8/" /><meta property="og:site_name" content="Adrià Pagès" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-26T08:10:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OSCP-8: Vulnerability Scanning" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Adrià"},"dateModified":"2022-07-26T08:10:00+02:00","datePublished":"2022-07-26T08:10:00+02:00","description":"Chapter 8: Vulnerability Scanning","headline":"OSCP-8: Vulnerability Scanning","mainEntityOfPage":{"@type":"WebPage","@id":"https://adriapt.github.io/posts/OSCP-8/"},"url":"https://adriapt.github.io/posts/OSCP-8/"}</script><title>OSCP-8: Vulnerability Scanning | Adrià Pagès</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Adrià Pagès"><meta name="application-name" content="Adrià Pagès"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/profilepic.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Adrià Pagès</a></div><div class="site-subtitle font-italic">My knowledge Hub</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about_me/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Adriapt" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['adria.pagest','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OSCP-8: Vulnerability Scanning</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>OSCP-8: Vulnerability Scanning</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658815800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 26, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Adrià Pagès Torruella </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1842 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="chapter-8-vulnerability-scanning">Chapter 8: Vulnerability Scanning</h1><hr /><p>Vulnerability Scanning is the process of detecting a known exploit/vulnerability when analyzing a victim. There are automated tools that do this process. They scan all the ports and identify the OS and services running, then, using techniques such as banner grabbing, they try to identify the version of those services and macth them with the signature of the known vulnerabilities. However, is common to have false positives and false negatives using these tools.</p><h2 id="nessus"><span class="mr-2">Nessus</span><a href="#nessus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nessus is one of the most used automatic vulnerability scanners. It was an open source project, but the source was closed. In consequence, some forks of the original source became open source under the name of OpenVAS (or Greenbone). However, Nessus has a free version which we will use to run an automated scan.</p><h3 id="installing-nessus"><span class="mr-2">Installing Nessus</span><a href="#installing-nessus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can install the corresponding package <a href="https://www.tenable.com/downloads/nessus">here</a>. In my case I am going to use the <strong>.deb</strong>.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>❯ <span class="nb">sudo </span>dpkg <span class="nt">-i</span> Nessus-10.3.0-debian9_amd64.deb
Selecting previously unselected package nessus.
<span class="o">(</span>Reading database ... 0 files and directories currently installed.<span class="o">)</span>
Preparing to unpack Nessus-10.3.0-debian9_amd64.deb ...
Unpacking nessus <span class="o">(</span>10.3.0<span class="o">)</span> ...
Setting up nessus <span class="o">(</span>10.3.0<span class="o">)</span> ...
Unpacking Nessus Scanner Core Components...
/var/lib/dpkg/info/nessus.postinst: line 34: deb-systemd-helper: <span class="nb">command </span>not found
/var/lib/dpkg/info/nessus.postinst: line 37: deb-systemd-helper: <span class="nb">command </span>not found
/var/lib/dpkg/info/nessus.postinst: line 44: deb-systemd-helper: <span class="nb">command </span>not found

 - You can start Nessus Scanner by typing /bin/systemctl start nessusd.service
 - Then go to https://FreeRaidr:8834/ to configure your scanner
</pre></table></code></div></div><p>As the output says, we can start the service doing <code class="language-plaintext highlighter-rouge">sudo systemctl start nessusd.service</code>:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>❯ <span class="nb">sudo </span>systemctl start nessusd.service
❯ <span class="nb">sudo </span>systemctl status nessusd.service
● nessusd.service - The Nessus Vulnerability Scanner
     Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/nessusd.service<span class="p">;</span> disabled<span class="p">;</span> preset: disabled<span class="o">)</span>
     Active: active <span class="o">(</span>running<span class="o">)</span> since Tue 2022-07-26 08:56:23 UTC<span class="p">;</span> 8s ago
   Main PID: 145862 <span class="o">(</span>nessus-service<span class="o">)</span>
      Tasks: 14 <span class="o">(</span>limit: 7664<span class="o">)</span>
     Memory: 114.9M
        CPU: 7.260s
     CGroup: /system.slice/nessusd.service
             ├─145862 /opt/nessus/sbin/nessus-service <span class="nt">-q</span>
             └─145863 nessusd <span class="nt">-q</span>

Jul 26 08:56:23 FreeRaidr systemd[1]: Started The Nessus Vulnerability Scanner.
Jul 26 08:56:24 FreeRaidr nessus-service[145863]: Cached 0 plugin libs <span class="k">in </span>0msec
Jul 26 08:56:24 FreeRaidr nessus-service[145863]: Cached 0 plugin libs <span class="k">in </span>0msec
</pre></table></code></div></div><p>Now we can open our browser and go to <strong>https://localhost:8834</strong>. When trying to access this web page, we will have an error indicating an unknown certificate issuer, because its SSL certificate is self-signed. Since we know it is not a dangerous application, we will accept the risk.</p><p>Next step is to choose what type of product we will be using, which will be <strong>Nessus Essentials</strong>. <img data-src="/img/posts/2022-07-26-OSCP-8/nessus_essentials.png" alt="nessus_products" data-proofer-ignore></p><p>Now we will need to fill the required information to receive an activation code in our email. Once we have it, we will be able to activate the product and create a User Account. Once the previous steps have been done, nessus will start to download plugins.</p><p>Now we will define our target. Nessus supports different types of scan such as:</p><ul><li><strong>Basic Network Scan:</strong> Generic scan with several checks to be used against various target types.<li><strong>Credentialed Patch Audit:</strong> Authenticated (The scanner has access to a user) scan to enumerate missing patches.<li><strong>Web Application Tests:</strong> Specialized scan for discovering known web vulnerabilities.<li><strong>Spectre and Meltdown:</strong> Targeted scan for <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)">Spectre</a> and <a href="https://en.wikipedia.org/wiki/Meltdown_(security_vulnerability)">Meltdown</a> vulnerabilities</ul><p>We are going to click <strong>New Scan</strong> and then <strong>Basic Network Scan</strong>. Now we will need to provide all the required arguments to execute the scan. I downloaded the <strong>Metasploitable VM</strong> machine to have a victim host where we can throw the scan.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/scan-config.png" alt="scan_config" data-proofer-ignore></p><p>The <strong>Basic Network Scan</strong> comes with a predefined configuration, however, we may want to change some values. For example, the predefined configuration defines that only the common ports will be scanned, but we want to scan <strong>all</strong> of them. To change this we will go to the <strong>Discovery</strong> tab and change the value of the scan type to <strong>Custom</strong>. This will add new tabs under the discovery tab. We will go to <strong>Port Scanning</strong> and we will see several options to define how we want to do the port scan.</p><p>We will first change the <strong>Port scan range</strong> and put the value <strong>0-65535</strong> (all ports).</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/all-ports.png" alt="scan-type" data-proofer-ignore></p><p>Now we will click the drop-down menu under the <strong>Save</strong> button and use the <strong>Launch</strong> to throw the scan.</p><p>This might take some time to execute. Since the <strong>Metasploitable</strong> machine has a lot of vulnerabilities on purpose, the scan will find a lot of things to expose.</p><p>Once the scan is completed, we can click on the scan name to show the results. If we click on the IP address we can see the vulnerabilities discovered in that target. We are able to filter the vulnerabilities by severity, exploitability, CVE, etc.</p><p>Nessus define some groups where some related vulnerabilities are grouped, but if we want to see all the vulnerabilities on a single page, we can disable this grouping format. The example below shows all the vulnerabilities with the filtered with the <strong>Exploit Available is equal to true</strong> filter.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/results.png" alt="scan-results" data-proofer-ignore></p><p>If we want to search for more vulnerabilities inside the host, we want to provide nessus with some credentials to access it. To do this we will do another scan, but this time we are going to select <strong>Credentialed Patch Audit</strong></p><p>We will need to provide again the IP and a name for the scan. However, now we will go to the <strong>Credentials</strong> tab and add the <strong>ssh</strong> credentials. Since I’m using the <strong>metasploitable machine</strong>, the default credentials are <strong>msfadmin:msfadmin</strong>. Since we want to use password authentication we have to select the corresponding method.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/password-config.png" alt="scan2-config" data-proofer-ignore></p><p>Now we can launch the attack as we did in the first scan and wait for the results.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/results2.png" alt="results-2" data-proofer-ignore></p><h3 id="nessus-plugins"><span class="mr-2">Nessus Plugins</span><a href="#nessus-plugins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>By default, Nessus enables a number of plugins when running a default scan, but we can define some other plugins to do a specific scan or search for a specific vulnerability. To do this we are going to create a <strong>New Scan</strong> but this time selecting the <strong>Advanced Scan</strong> configuration. Now we will go to the <strong>Plugins</strong> tab and we will see all the enabled plugins. We can disable them using the <strong>Disable All</strong> button.</p><p>If we want to scan for a specific vulnerability, for example the <strong>NFS Exported Share Information Disclosure</strong> we will go to the RPC tab in the left column and several plugins will be displayed on the right column, where we will select the <strong>NFS Exported Share Information Disclosure</strong>, with the ID: <strong>11356</strong>.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/nfs.png" alt="nfs-plugin" data-proofer-ignore></p><p>Now we can launch the scan and wait for the results. We can see that it is vulnerable.</p><p><img data-src="/img/posts/2022-07-26-OSCP-8/results3.png" alt="results-3" data-proofer-ignore></p><h2 id="using-nmap"><span class="mr-2">Using Nmap</span><a href="#using-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nmap can also scan for vulnerabilities using the Nmap Script Engine (NSE). These scripts are written in Lua. Some scripts can exploit the vulnerability and they may destroy the host, this is why the scripts are categorized as <strong>safe</strong> or <strong>intrusive</strong>.</p><p>If we keep using the Metasploitable machine as an example, we can scan for vulnerabilities using: <code class="language-plaintext highlighter-rouge">sudo nmap --script vuln 192.168.194.128</code></p><p>This is a short extract of the huge output:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
</pre><td class="rouge-code"><pre>❯ <span class="nb">sudo </span>nmap <span class="nt">--script</span> vuln 192.168.194.128
passwd: 
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-07-26 11:26 UTC
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS <span class="o">(</span>CVE-2011-1002<span class="o">)</span><span class="nb">.</span>
|_  Hosts are all up <span class="o">(</span>not vulnerable<span class="o">)</span><span class="nb">.</span>

Nmap scan report <span class="k">for </span>192.168.194.128
Host is up <span class="o">(</span>0.00047s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 977 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE <span class="o">(</span>Exploitable<span class="o">)</span>
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure <span class="nb">date</span>: 2011-07-03
|     Exploit results:
|       Shell <span class="nb">command</span>: <span class="nb">id</span>
|       Results: <span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
|     References:
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2011-2523
|_      https://www.securityfocus.com/bid/48539
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
|_sslv2-drown: ERROR: Script execution failed <span class="o">(</span>use <span class="nt">-d</span> to debug<span class="o">)</span>
| ssl-dh-params: 
|   VULNERABLE:
|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
|     State: VULNERABLE
|       Transport Layer Security <span class="o">(</span>TLS<span class="o">)</span> services that use anonymous
|       Diffie-Hellman key exchange only provide protection against passive
|       eavesdropping, and are vulnerable to active man-in-the-middle attacks
|       which could completely compromise the confidentiality and integrity
|       of any data exchanged over the resulting session.
|     Check results:
|       ANONYMOUS DH GROUP 1
|             Cipher Suite: TLS_DH_anon_WITH_AES_128_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: postfix <span class="nb">builtin</span>
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|       https://www.ietf.org/rfc/rfc2246.txt
|   
|   Transport Layer Security <span class="o">(</span>TLS<span class="o">)</span> Protocol DHE_EXPORT Ciphers Downgrade MitM <span class="o">(</span>Logjam<span class="o">)</span>
|     State: VULNERABLE
|     IDs:  BID:74733  CVE:CVE-2015-4000
|       The Transport Layer Security <span class="o">(</span>TLS<span class="o">)</span> protocol contains a flaw that is
|       triggered when handling Diffie-Hellman key exchanges defined with
|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
|       to downgrade the security of a TLS session to 512-bit export-grade
|       cryptography, which is significantly weaker, allowing the attacker
|       to more easily <span class="nb">break </span>the encryption and monitor or tamper with
|       the encrypted stream.
|     Disclosure <span class="nb">date</span>: 2015-5-19
|     Check results:
|       EXPORT-GRADE DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       https://weakdh.org
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2015-4000
|       https://www.securityfocus.com/bid/74733
|   
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security <span class="o">(</span>TLS<span class="o">)</span> services that use Diffie-Hellman <span class="nb">groups</span>
|       of insufficient strength, especially those using one of a few commonly
|       shared <span class="nb">groups</span>, may be susceptible to passive eavesdropping attacks.
|     Check results:
|       WEAK DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: postfix <span class="nb">builtin</span>
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|_      https://weakdh.org
| smtp-vuln-cve2010-4344: 
|_  The SMTP server is not Exim: NOT VULNERABLE
| ssl-poodle: 
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  BID:70574  CVE:CVE-2014-3566
|           The SSL protocol 3.0, as used <span class="k">in </span>OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           <span class="k">for </span>man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the <span class="s2">"POODLE"</span> issue.
|     Disclosure <span class="nb">date</span>: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2014-3566
|_      https://www.securityfocus.com/bid/70574
53/tcp   open  domain
80/tcp   open  http
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on <span class="s1">'apache/2.2.8 (ubuntu) dav/2'</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/oscp-study-guide/'>OSCP-Study-Guide</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/oscp/" class="post-tag no-text-decoration" >OSCP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OSCP-8%3A+Vulnerability+Scanning+-+Adri%C3%A0+Pag%C3%A8s&url=https%3A%2F%2Fadriapt.github.io%2Fposts%2FOSCP-8%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OSCP-8%3A+Vulnerability+Scanning+-+Adri%C3%A0+Pag%C3%A8s&u=https%3A%2F%2Fadriapt.github.io%2Fposts%2FOSCP-8%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fadriapt.github.io%2Fposts%2FOSCP-8%2F&text=OSCP-8%3A+Vulnerability+Scanning+-+Adri%C3%A0+Pag%C3%A8s" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CySA/">CySA+ Preparation Content</a><li><a href="/posts/HTB_Timelapse/">Htb_timelapse</a><li><a href="/posts/wellcome/">Welcome</a><li><a href="/posts/OSCP-Starting/">OSCP-Starting Point</a><li><a href="/posts/OSCP-9/">OSCP-9: Web-based Vulnerabilities</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp/">OSCP</a> <a class="post-tag" href="/tags/active-directory/">Active_Directory</a> <a class="post-tag" href="/tags/basics/">Basics</a> <a class="post-tag" href="/tags/oscp-bash/">OSCP Bash</a> <a class="post-tag" href="/tags/windows/">Windows</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OSCP-Starting/"><div class="card-body"> <em class="small" data-ts="1657951800" data-df="ll" > Jul 16, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSCP-Starting Point</h3><div class="text-muted small"><p> OSCP STUDY WALKTHROUGH Edit: I was studying for the OSCP but I started a new job as a Security Analyst. Since this certification requires a lot of study and time, I decided to stop and invest tha...</p></div></div></a></div><div class="card"> <a href="/posts/OSCP-6/"><div class="card-body"> <em class="small" data-ts="1658211000" data-df="ll" > Jul 19, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSCP-6: Passive Information Gathering</h3><div class="text-muted small"><p> Chapter 6: Passive Information Gathering Depending on the pentest that you are doing, the first step may be gathering openly available information about the target without directly interacting wi...</p></div></div></a></div><div class="card"> <a href="/posts/OSCP-7/"><div class="card-body"> <em class="small" data-ts="1658383800" data-df="ll" > Jul 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSCP-7: Active Information Gathering</h3><div class="text-muted small"><p> Chapter 7: Active Information Gathering In the previous post we explored some ways to obtain information about a user without directly interacting with him, but in this post we will explore the m...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OSCP-7/" class="btn btn-outline-primary" prompt="Older"><p>OSCP-7: Active Information Gathering</p></a> <a href="/posts/OSCP-9/" class="btn btn-outline-primary" prompt="Newer"><p>OSCP-9: Web-based Vulnerabilities</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="">Adrià Pagès Torruella</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/oscp/">OSCP</a> <a class="post-tag" href="/tags/active-directory/">Active_Directory</a> <a class="post-tag" href="/tags/basics/">Basics</a> <a class="post-tag" href="/tags/oscp-bash/">OSCP Bash</a> <a class="post-tag" href="/tags/windows/">Windows</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
